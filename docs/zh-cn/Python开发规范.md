# Python 开发规范

---

## **1. 遵循 PEP 8 代码风格**
PEP 8 是 Python 官方推荐的代码风格指南：
- **缩进**：使用 4 个空格，而非 Tab。
- **行长度**：尽量限制在 79 字符以内；文档字符串和注释建议限制在 72 字符以内。
- **空行**：
  - 顶层函数和类定义之间用两行空行分隔。
  - 类内方法之间用一行空行分隔。
- **空格**：
  - 二元操作符（`=`、`==` 等）两侧各加一个空格，但参数列表中的 `=` 两边不加空格（如 `func(arg=10)`）。
  - 不要在括号内、列表或字典的中括号内部添加多余空格。
- **注释**：
  - 注释应简洁明了，使用完整句子，首字母大写。
  - 代码块注释前后用空行隔开。
- **命名**：
  - 变量、函数和方法使用`小写_加下划线`（如 `my_variable`）。
  - 常量使用全大写字母和下划线分隔（如 `MAX_SIZE`）。
  - 类名使用大驼峰命名（如 `MyClass`）。

---

## **2. 编码规范**
### **文件组织**
- **导入顺序**：
  1. 标准库导入（如 `os`, `sys`）。
  2. 第三方库导入（如 `numpy`, `pandas`）。
  3. 本地模块导入。
- **避免循环导入**：重构模块或类以避免依赖关系。

### **函数与类**
- 函数尽量保持短小，完成单一任务。
- 使用明确的参数名，并尽量提供默认值。
- 类方法中使用 `self` 或 `cls` 表示实例和类对象。
- 使用 `__init__` 定义类的初始化操作。

### **异常处理**
- 捕获特定异常而非使用通配符 `except Exception:`。
- 始终使用上下文管理器处理文件或资源，如：
  ```python
  with open('file.txt', 'r') as f:
      data = f.read()
  ```

### **类型注解**
- 使用类型注解提高代码可读性：
  ```python
  def add(a: int, b: int) -> int:
      return a + b
  ```

---

## **3. 工具和框架**
- 使用代码格式化工具：如 **Black** 或 **YAPF**。
- 静态代码分析工具：如 **Flake8**、**Pylint**。
- 类型检查工具：如 **mypy**。
- 自动化测试工具：如 **pytest**、**unittest**。

---

## **4. 文档与注释**
- 使用 **docstring** 为模块、类和函数提供文档，推荐遵循 Google 或 NumPy 风格：
  ```python
  def add(a: int, b: int) -> int:
      """
      Adds two numbers.

      Args:
          a (int): First number.
          b (int): Second number.

      Returns:
          int: The sum of the two numbers.
      """
      return a + b
  ```
- 在代码复杂处添加必要注释，避免代码自解释性不足。

---

## **5. 测试**
- 为每个模块或函数编写测试用例，覆盖不同场景和边界条件。
- 使用断言检查代码行为：
  ```python
  def test_add():
      assert add(2, 3) == 5
  ```
- 遵循“单一职责”原则，为每个测试函数测试单一功能。

---

## **6. 性能优化**
- 优先使用生成器和迭代器，避免不必要的内存消耗：
  ```python
  def squares(n):
      for i in range(n):
          yield i * i
  ```
- 使用内置函数和库（如 `map`、`filter` 或 `itertools`）来简化代码。

---

## **7. 版本控制**
- 使用 Git 进行版本管理，确保代码的可追溯性。
- 遵循分支策略：如 `main` / `develop` / `feature-*`。
- 编写清晰的提交信息：
  ```
  Add: 新增用户认证功能
  Fix: 修复登录页面的闪退问题
  Refactor: 重构数据处理模块
  ```

---

## **8. 配置管理**
- 将敏感信息（如 API 密钥）存储在环境变量中，避免硬编码。
- 使用 `.env` 文件和 **python-dotenv** 库加载环境变量。

---

通过遵循这些规范，可以提高代码的可读性、可维护性和扩展性。对于团队开发，建议编写项目特定的代码规范文档并定期进行代码审查。

